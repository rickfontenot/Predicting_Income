"0","library(rknn)"
"2","Loading required package: gmp
"
"2","
Attaching package: ‘gmp’

"
"2","The following objects are masked from ‘package:Matrix’:

    crossprod, tcrossprod

"
"2","The following objects are masked from ‘package:base’:

    %*%, apply, crossprod, matrix, tcrossprod

"
"0","scaled.training<-drop_na(scaled.training)"
"0",""
"0","sum(is.na(scaled.training))"
"1","[1]"
"1"," 0"
"1","
"
"0","str(scaled.training)"
"1","'data.frame':	"
"1",""
"1","1191"
"1",""
"1"," obs. of  "
"1",""
"1","23"
"1",""
"1"," variable"
"1",""
"1","s"
"1",""
"1",":"
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Country                                 "
"1",""
"1",":"
"1"," chr  "
"1",""
"1","""Afghanistan"" ""Afghanistan"" ""Afghanistan"" ""Afghanistan"""
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Year                                    "
"1",""
"1",":"
"1"," int  "
"1",""
"1","2010 2009 2008 2007 2006 2005 2004 2003 2002 2010"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Life.expectancy                         "
"1",""
"1",":"
"1"," num  "
"1",""
"1","58.8 58.6 58.1 57.5 57.3 57.3 57 56.7 56.2 76.2"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Adult.Mortality                         "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.385 0.388 0.396 0.407 0.407"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","infant.deaths                           "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.0411 0.0428 0.0444 0.0456 0.0467"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Alcohol                                 "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0 0 0.00112 0.00056 0.00112"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Hepatitis.B                             "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.66 0.629 0.639 0.629 0.639"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Measles                                 "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.01513 0.02177 0.01217 0.00868 0.01514"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","under.five.deaths                       "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.0408 0.0424 0.044 0.0452 0.0464 0.0472 0.048 0.0488 0.0488 0.0004"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Total.expenditure                       "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.63 0.646 0.568 0.454 0.504"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Diphtheria                              "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.66 0.629 0.639 0.629 0.577"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","HIV.AIDS                                "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0 0 0 0 0 0 0 0 0 0"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","thinness..1.19.years                    "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.663 0.67 0.678 0.685 0.692"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","thinness.5.9.years                      "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.642 0.653 0.66 0.667 0.674"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Schooling                               "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.358 0.341 0.33 0.313 0.296"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","EstPopulation                           "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.0209 0.0203 0.0197 0.0191 0.0185"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","EstGDPpercapita                         "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.00346 0.00263 0.00207 0.00205 0.00129"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","CorrectedExpenditure                    "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.003989 0.002855 0.001304 0.000552 0.00087"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","new.Adult.Mortality                     "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.317 0.325 0.332 0.345 0.349"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","WHO.BMI.metric                          "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.225 0.217 0.208 0.2 0.192"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","EstPolio                                "
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.637 0.604 0.615 0.604 0.549"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","filtered.Income.composition.of.resources"
"1",""
"1",":"
"1"," num  "
"1",""
"1","0.281 0.26 0.259 0.233 0.219"
"1",""
"1"," ..."
"1",""
"1","
"
"1"," "
"1",""
"1","$ "
"1",""
"1","Developed                               "
"1",""
"1",":"
"1"," int  "
"1",""
"1","0 0 0 0 0 0 0 0 0 0"
"1",""
"1"," ..."
"1",""
"1","
"
"0","selections1<-rknnBeg(scaled.training %>% select(-Country,-Year,-Life.expectancy,-Adult.Mortality), scaled.training$Life.expectancy, k = 5)"
"0",""
"0","bestset(selections1, criterion=c(""mean_accuracy"", ""mean_support""))"
"1","[1]"
"1"," ""new.Adult.Mortality""                     "
"1"," ""filtered.Income.composition.of.resources"""
"1","
"
"1","[3]"
"1"," ""HIV.AIDS""                                "
"1"," ""Schooling""                               "
"1","
"
"1","[5]"
"1"," ""WHO.BMI.metric""                          "
"1","
"
"0","#Best = new.Adult.Mortality,filtered.Income.composition.of.resources,HIV.AIDS,thinness.5.9.years,WHO.BMI.metric"
"0",""
"0","training.set2<-scaled.training %>% select(Life.expectancy,new.Adult.Mortality,filtered.Income.composition.of.resources,HIV.AIDS,thinness.5.9.years,WHO.BMI.metric)"
"0","test.set2<-scaled.test %>% select(Life.expectancy,new.Adult.Mortality,filtered.Income.composition.of.resources,HIV.AIDS,thinness.5.9.years,WHO.BMI.metric)"
"0",""
"0","accs2 = data.frame(RMSE = numeric(50), AIC = numeric(50), k = numeric(50))"
"0",""
"0","for(i in 1:50)"
"0","{"
"0","  fit = knnreg(training.set2$Life.expectancy ~ ., data = training.set2, k=i)"
"0","  parameters=length(attr(fit[3]$terms,""predvars""))-1"
"0","    prediction<-predict(fit, test.set2)"
"0","  accs2$RMSE[i] = RMSE(test.set2$Life.expectancy, prediction)"
"0","  accs2$AIC[i] = calcAIC(test.set2$Life.expectancy,prediction,parameters)"
"0","  accs2$k[i] = i"
"0","}"
"0",""
"0","accs2 %>% ggplot(aes(x = k, y = AIC)) + geom_line()"
