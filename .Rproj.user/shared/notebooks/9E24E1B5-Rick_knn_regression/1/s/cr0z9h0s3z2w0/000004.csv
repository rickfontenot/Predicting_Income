"0",""
"0","RMSE(scaled.test$Life.expectancy, scaled.test$prediction)"
"1","[1]"
"1"," 2.605181"
"1","
"
"0","#RMSE=2.605"
"0",""
"0",""
"0","calcAIC <- function(actual, predicted, parameters){"
"0","  resids = actual - predicted"
"0","  n = length(predicted)"
"0","  sse = sum(resids^2)"
"0","  AIC =  n * log(sse/n) + 2*(parameters + 1)"
"0","  print(return(AIC))"
"0","}"
"0",""
"0","calcAIC(scaled.test$Life.expectancy,scaled.test$prediction,length(attr(fit[3]$terms,""predvars""))-1)"
"1","[1]"
"1"," 1116.402"
"1","
"
"0","accs = data.frame(RMSE = numeric(50), AIC = numeric(50), k = numeric(50))"
"0",""
"0","for(i in 1:50)"
"0","{"
"0","  fit = knnreg(scaled.training$Life.expectancy ~ ., data = scaled.training %>% select(-Country,-Year), k=i)"
"0","  parameters=length(attr(fit[3]$terms,""predvars""))-1"
"0","    prediction<-predict(fit, scaled.test)"
"0","  accs$RMSE[i] = RMSE(scaled.test$Life.expectancy, prediction)"
"0","  accs$AIC[i] = calcAIC(scaled.test$Life.expectancy,prediction,parameters)"
"0","  accs$k[i] = i"
"0","}"
"0",""
"0","accs %>% ggplot(aes(x = k, y = AIC)) + geom_line()"
