"0","split_holder <- data.frame(decimal = NA, accuracy = NA, sens = NA, spec = NA, difference = NA)"
"0","counter = 0"
"0","min_prob <- ifelse(ceiling(min(probability$above_fifty) * 1000) > 0, ceiling(min(probability$above_fifty) * 1000), 1)"
"0","max_prob <- ifelse(floor(max(probability$above_fifty) * 1000) == 1000, 999, floor(max(probability$above_fifty)))"
"0",""
"0","for (i in seq(min_prob, max_prob)) {"
"0","  decimal <- i / 1000"
"0","  counter = counter + 1"
"0","  "
"0","  prediction <- if_else(probability$above_fifty > decimal, ""above_fifty"", ""below_fifty"")"
"0","  x <- confusionMatrix(table(prediction, test$income))"
"0",""
"0","  split_holder[counter,1] <- decimal"
"0","  split_holder[counter,2] <- x$overall[1]"
"0","  split_holder[counter,3] <- x$byClass[1]"
"0","  split_holder[counter,4] <- x$byClass[2]"
"0","  split_holder[counter,5] <- abs(x$byClass[1] - x$byClass[2])"
"0","} "
"0","best_split <-(split_holder %>% filter(difference == min(difference)))$decimal"
"0",""
"0","prediction <- if_else(probability$above_fifty > best_split, ""above_fifty"", ""below_fifty"")"
"0","confusionMatrix(table(prediction, test$income))"
"1","Confusion Matrix and Statistics

"
"1","             
"
"1","prediction   "
"1"," above_fifty"
"1"," below_fifty"
"1","
  above_fifty"
"1","        1208"
"1","        1187"
"1","
  below_fifty"
"1","         383"
"1","        3734"
"1","
"
"1",""
"1","                         "
"1","                 "
"1","
"
"1","               Accuracy :"
"1"," 0.7589          "
"1","
"
"1","                 95% CI :"
"1"," (0.7483, 0.7693)"
"1","
"
"1","    No Information Rate :"
"1"," 0.7557          "
"1","
"
"1","    P-Value [Acc > NIR] :"
"1"," 0.2777          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","                  Kappa :"
"1"," 0.4424          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1"," Mcnemar's Test P-Value :"
"1"," <2e-16          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","            Sensitivity :"
"1"," 0.7593          "
"1","
"
"1","            Specificity :"
"1"," 0.7588          "
"1","
"
"1","         Pos Pred Value :"
"1"," 0.5044          "
"1","
"
"1","         Neg Pred Value :"
"1"," 0.9070          "
"1","
"
"1","             Prevalence :"
"1"," 0.2443          "
"1","
"
"1","         Detection Rate :"
"1"," 0.1855          "
"1","
"
"1","   Detection Prevalence :"
"1"," 0.3678          "
"1","
"
"1","      Balanced Accuracy :"
"1"," 0.7590          "
"1","
"
"1","                         "
"1","                 "
"1","
"
"1","       'Positive' Class :"
"1"," above_fifty     "
"1","
"
"1","                         "
"1","                 "
"1","
"
